---
layout: default
title: Количественные формулы
use_math: true

---

# Количественные формулы
### Оглавление
1. [Закон Амдала](#amdahl)
  * [Пример](#amdahlex)
  * [Задачи]({{ site.baseurl }}/hprs/quants/#amdahl)
2. [Средние](#means)
  * [Задачи]({{ site.baseurl }}/hprs/quants/#means)

## Закон Амдала <a name="amdahl" />
Самая популярная формула, для вычисления настоящей степени улучшения всей системы.
Постановка следующая.
Пусть мы улучшили некоторую часть всей системы ``(какую-нибудь функцию, конкретную схему и т.п.)``
и хотим понять, как это улучшение скажется на всей системе.
Тогда совершенно очевидно, что

$$
	\text{Ускорение всей системы} =
	\frac{\text{Время исполнения до нововведений}}{\text{Время исполнения после нововведений}}
$$

Пусть улучшения коснулись лишь $\text{Доля улучшений}$ системы.
Значит $1 - \text{Доля улучшений}$ системы остались без изменений.
Тогда мы можем выразить новое время через старое:

$$
	\text{Время исполнения}_{\text{новое}} = \\
	\text{Врямя исполнения}_{\text{старое}} \times (1 - \text{Доля улучшений}) + 
	\text{Врямя исполнения}_{\text{старое}} \times \cfrac 1 {\text{Ускорение улучшений}} \times \text{Доля улучшений} = \\
	\text{Врямя исполнения}_{\text{старое}} \times 
	\left ( (1 - \text{Доля улучшений}) + \cfrac{\text{Доля улучшений}}{\text{Ускорение улучшений}} \right )
$$

Итого, имеем

$$
			\text{Ускорение}_{\text{полное}} =
			\cfrac 1 { ( 1 – \text{Доля улучшений}) + \cfrac{\text{Доля улучшений}}{\text{Ускорение улучшений}} }
$$

Как его применять?
Например, решим такую задачку: <a name="amdahlex" />
> Suppose that we want to enhance the processor used for web serving. The new
> processor is 10 times faster on computation in the web serving application than
> the old processor. Assuming that the original processor is busy with computation
> 40% of the time and is waiting for I/O 60% of the time, what is the overall speedup
> gained by incorporating the enhancement?

Легко видеть, что $\text{Доля улучшений} = 0.4$, $\text{Ускорение улучшений} = 10$.
Значит

$$
			\text{Ускорение}_{\text{полное}} =
			\cfrac 1 { ( 1 – \text{Доля улучшений}) + \cfrac{\text{Доля улучшений}}{\text{Ускорение улучшений}} } = 
			\cfrac 1 {0.6 + \cfrac{0.4}{10}} = \cfrac 1 {0.64} = 1.5625
$$

## Средние <a name="means" />
Напомню, что средние упоминались в связи с тестами производительности ``(benchmarks)``.
Мотивировка следующая: тесты производительности, например [SPEC](https://spec.org), используют несколько тестов в своих наборах.
Поэтому при проверке на наборе тестов компьютер $A$ генерирует последовательность времён выполнения:

$$
	T_1, T_2, \dots, T_n
$$

Затем берётся эталонный компьютер $R$, у которого соответствующая последовательность такая:

$$
	t_1, t_2, \dots, t_n
$$

и считают результатом $i$-ого теста величину $A_i = \cfrac{t_i}{T_i}$.

Но для сравнения системы $A$ с ситсемой $B$ надо получить только одно число $n$.
При этом имеется два требования:
1. $n$ должно зависеть от $A$ и $B$, но не от $R$
1. $n$ должно *выражать отношение* производительности систем $A$ и $B$.

Утверждается, что арифметическое среднее не удовлетворяет этим требованиям.
При этом *геометрическое среднее* им удовлетворяет:

$$
	{GM}^n = \prod_{i = 1}^n A_i.
$$
